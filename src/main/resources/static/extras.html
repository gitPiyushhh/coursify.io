<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org" style="height: 91%; padding: 0;">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coursify.io | extras</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gluten:wght@300;400;500&display=swap" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600&display=swap" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- <link rel="stylesheet" href="./styles/style.css"> -->
    <link rel="stylesheet" type="text/css" href="./styles/style.css">

</head>

<body>
    <nav class="navbar">
        <ul class="u-flex">
            <a class="logo" href="./index.html" style="cursor: pointer;">Coursify.io</a>
            <div class="u-flex">
                <li class="dropdown">
                    <a href="#" class="dropbtn">Courses</a>
                    <div class="dropdown-content">
                        <a href="#" style="font-family: 'inter' ; font-size: 14px;" id="addCourseBtn">Create course</a>
                        <a style="font-family: 'inter'; font-size: 14px;" href="./courses">Get all courses</a>
                        <a href="#" style="font-family: 'inter'; font-size: 14px;" id="deleteCourseBtn">Delete
                            course</a>
                        <!-- <a href="#" style="font-family: 'inter'; font-size: 14px;">Get course with ID</a>
                        <a href="#" style="font-family: 'inter'; font-size: 14px;">Get course with student name</a> -->
                    </div>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropbtn">Students</a>
                    <div class="dropdown-content">
                        <a href="#" style="font-family: 'inter'; font-size: 14px;" id="addStudentBtn">Create student</a>
                        <a style="font-family: 'inter'; font-size: 14px;" href="./students">Get all
                            students</a>
                        <a href="./extras.html" style="font-family: 'inter'; font-size: 14px;" id="linkLink">Link to course</a>
                        <a href="./extras.html" style="font-family: 'inter'; font-size: 14px;" id="delinkLink">Delink from course</a>
                    </div>
                </li>
                <li><a href="./sysdesign.html" class="dropbtn" style="text-decoration: none;">System design</a></li>
                <li><a href="https://documenter.getpostman.com/view/17555530/2s9Y5eLyHo" target="_blank" class="dropbtn"
                        style="text-decoration: none;">Documentation</a></li>
                <li class="userAvatar"></li>
            </div>
        </ul>
    </nav>

    <div class="" style="width: 80vw; margin: auto;" id="linkBlock">
        <div class="u-flex" style="width: 80vw; margin: auto;">
            <form class="form active" style="height: 90%;" id="form9">
                <div class="u-flex">
                    <label for="courseNameVal" class="label" id="courseName">Course ID</label>
                    <input type="text" id="courseNameVal1" class="input" placeholder="Enter the course ID" required>
                </div>

                <div class="u-flex u-margin-top-3">
                    <label for="courseNameVal" class="label" id="courseName2">Student ID</label>
                    <input type="text" id="courseNameVal2" class="input" placeholder="Enter the student ID" required>
                </div>

                <br>
                <button type="submit" class="button" style="width: 100%; margin-top: 1rem;" id="createCourseBtn2">Link
                    Student</button>
            </form>


            <img src="./images/linked2.png" alt="Nothing"
                style="width: 42vw; height: 100%; display: block;  margin-top: 2rem; opacity: 95%;" class=""
                id="linkIllust">
        </div>
    </div>

    <div class="remove" style="width: 80vw; margin: auto;" id="delinkBlock">
        <div class="u-flex" style="width: 80vw; margin: auto;">
            <form class="form active" style="height: 90%;" id="form10">
                <div class="u-flex">
                    <label for="courseNameVal" class="label" id="courseName">Course ID</label>
                    <input type="text" id="courseNameVal3" class="input" placeholder="Enter the course ID" required>
                </div>

                <div class="u-flex u-margin-top-3">
                    <label for="courseNameVal" class="label" id="courseName2">Student ID</label>
                    <input type="text" id="courseNameVal4" class="input" placeholder="Enter the student ID" required>
                </div>

                <br>
                <button type="submit" class="button" style="width: 100%; margin-top: 1rem;" id="createCourseBtn3">Delink
                    Student</button>
            </form>


            <img src="./images/delink.png" alt="Nothing"
                style="width: 42vw; height: 100%; display: block;  margin-top: 2rem; opacity: 95%;" class=""
                id="linkIllust">
        </div>
    </div>

    <div class="footer">
        <p class="footer_text">Curated with â™¥ by Piyush</p>
    </div>



    <script>
        document.addEventListener("DOMContentLoaded", function () {

            const linkBlock = document.getElementById("linkBlock");
            const delinkBlock = document.getElementById("delinkBlock");

            delinkLink.addEventListener("click", function (e) {
                e.preventDefault();
                linkBlock.classList.add("remove");
                delinkBlock.classList.remove("remove");
            });

            linkLink.addEventListener("click", function (e) {
                e.preventDefault();
                linkBlock.classList.remove("remove");
                delinkBlock.classList.add("remove");
            });
        });

        document.addEventListener("DOMContentLoaded", function () {
            const form = document.getElementById("form9");
            const createCourseBtn = document.getElementById("createCourseBtn2");

            createCourseBtn.addEventListener("click", function (e) {
                e.preventDefault(); // Prevent the default form submission

                // Get the values of courseNameVal1 and courseNameVal2 inputs
                const courseNameVal = document.getElementById("courseNameVal1").value;
                const studentId = document.getElementById("courseNameVal2").value;

                document.getElementById("courseNameVal1").value = "";
                document.getElementById("courseNameVal2").value = "";

                // Create a JavaScript object with the data
                const data = {
                    courseId: courseNameVal,
                    studentId: studentId,
                };


                fetch(`/api/courses/${courseNameVal}/students/${studentId}`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(data),
                })
                    .then((response) => {
                        if (response.ok) {
                            alert("Student linked to the course successfully!");
                        } else {
                            alert("Failed to link student to the course.");
                        }
                    })
                    .catch((error) => {
                        console.error("Error:", error);
                    });
            });
        });

        document.addEventListener("DOMContentLoaded", function () {
            const form = document.getElementById("form10");
            const delinkStudentBtn = document.getElementById("delinkStudentBtn");

            form.addEventListener("submit", function (e) {
                e.preventDefault(); 
                const courseId = document.getElementById("courseNameVal3").value;
                const studentId = document.getElementById("courseNameVal4").value;

                fetch(`/api/students/${studentId}/courses/${courseId}`, {
                    method: "DELETE",
                })
                    .then((response) => {
                        if (response.ok) {
                            alert("Student delinked successfully!");
                        } else if (response.status === 400) {
                            alert("Student is not linked to the course.");
                        } else if (response.status === 404) {
                            alert("Student or course not found.");
                        } else {
                            alert("Failed to delink student from the course.");
                        }
                    })
                    .catch((error) => {
                        console.error("Error:", error);
                    });
            });
        });
    </script>


    <script src="./scripts/script.js"></script>
</body>

</html>